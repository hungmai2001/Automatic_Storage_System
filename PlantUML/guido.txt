@startuml
participant ESP32CAM
box #LightBlue
participant FrontEnd
participant BackEnd 
end box 
participant ESP32
activate FrontEnd
activate ESP32
activate ESP32CAM
activate BackEnd

FrontEnd --> FrontEnd : **<color red>Nhấn nút GỬI ĐỒ</color>**
activate FrontEnd #005500
== **<color green>Thu thập khuôn mặt</color>** ==
FrontEnd --> ESP32CAM : [websocket] Capture
loop until face detected 10 times continuously
   activate ESP32CAM #20a4d8
   ESP32CAM --> FrontEnd : [websocket] Gửi hình ảnh
   FrontEnd --> FrontEnd : Nhận diện khuôn mặt, hiển thị hình ảnh
end
FrontEnd --> ESP32CAM : [MQTT] Dừng capture
deactivate ESP32CAM 
FrontEnd --> FrontEnd : Tải xuống hình ảnh
deactivate FrontEnd
BackEnd --> BackEnd : Phát hiện hình ảnh trong folder download
activate BackEnd #ef2731 
== **<color green>Thu thập vân tay</color>** ==
BackEnd --> ESP32: [MQTT] Lấy mẫu vân tay
activate ESP32 #efde27
ESP32 --> ESP32 : Lấy mẫu vân tay
ESP32 --> ESP32 : Cập nhật led tủ
ESP32 --> BackEnd : [MQTT] Thông báo đã lưu vân tay
deactivate ESP32
BackEnd --> BackEnd : Lưu hình ảnh vào database [id]
BackEnd --> FrontEnd : [MQTT] Đã lưu hình ảnh và vân tay
deactivate BackEnd 
activate FrontEnd #005500
FrontEnd -> FrontEnd: Hiển thị thông báo/nút nhấn
@enduml